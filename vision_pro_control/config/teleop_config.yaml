# VisionPro 遥操作配置文件

# VisionPro 连接
visionpro:
  ip: "192.168.1.125"
  use_right_hand: true

# 机械臂连接
robot:
  ip: "192.168.8.10"

# 标定文件
calibration:
  file: "config/calibration.yaml"

# 坐标映射参数
mapper:
  position_gain: 0.3          # 位置增益（提高到0.8以适应球形空间）
  rotation_gain: 0.3          # 旋转增益
  max_linear_velocity: 0.01    # Mapper内部最大线速度 (m/s) - 第一层限制
  max_angular_velocity: 0.05   # Mapper内部最大角速度 (rad/s) - 第一层限制
  filter_alpha: 0.2           # 滤波系数 (0-1)

  # 注意：deadzone_radius 现在在 calibration.yaml 中定义
  # mapper 的速度限制是第一层保护，确保映射输出在合理范围

# 安全限制（双重保护机制）
safety:
  max_linear_velocity: 0.005   # 最终安全限速 (m/s) - 第二层保护（降低用于测试）
  max_angular_velocity: 0.03   # 最终安全角速度限制 (rad/s) - 第二层保护（降低用于测试）
  enable_safety_check: true   # 启用安全检查

  # 说明：双重安全保护机制
  # 1. CoordinateMapper 先将速度限制在 mapper.max_* 范围内
  # 2. RobotCommander 再次检查并限制到更严格的 safety.max_*
  # 3. 这是双重安全保护，防止任何情况下速度过快
  # 4. 实际机械臂速度 = min(mapper限制, safety限制)

# 夹爪控制（新增连续控制模式）
gripper:
  control_mode: "continuous"  # "continuous" 或 "binary"
  
  # 连续控制参数
  pinch_distance_open: 0.08   # 完全张开时的捏合距离 (m)
  pinch_distance_close: 0.01  # 完全闭合时的捏合距离 (m)
  
  # 夹爪位置范围
  gripper_open_position: 0.0   # 夹爪完全张开
  gripper_close_position: 0.8  # 夹爪完全闭合
  
  max_effort: 100.0            # 最大力度
  update_threshold: 0.005      # 位置变化阈值，小于此值不发送指令 (避免抖动)
  
  # 向后兼容：二值控制参数（如果 control_mode = "binary"）
  pinch_threshold: 0.02        # 捏合判定阈值
  open_position: 0.0
  close_position: 0.8